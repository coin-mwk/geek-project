{"ast":null,"code":"import request from \"@/utils/request\";\nimport { setLocalChannels, getLocalChannels } from \"@/utils/storage\";\nimport { hasToken } from \"@/utils/storage\";\n/**\n * 将用户频道保存到 Redux\n * @param {Array} channels\n * @returns\n */\n\nexport const saveUserChannels = channels => {\n  return {\n    type: 'home/channel',\n    payload: channels\n  };\n};\n/**\n * 获取频道\n * @returns thunk\n */\n\nexport const getUserChannels = () => {\n  return async dispatch => {\n    // 1. 判断用户是否登录\n    if (hasToken()) {\n      const res = await request.get('/user/channels');\n      dispatch(saveUserChannels(res.data.channels));\n    } else {\n      // 2. 没有token,从本地获取频道数据\n      const channels = getLocalChannels();\n\n      if (channels) {\n        // 没有token，但本地有channels数据\n        dispatch(saveUserChannels(channels));\n      } else {\n        // 没有token, 且本地没有channels数据\n        const res = await request.get('/user/channels');\n        dispatch(saveUserChannels(res.data.channels)); // 保存到本地\n\n        setLocalChannels(res.data.channels);\n      }\n    }\n  };\n};","map":{"version":3,"names":["request","setLocalChannels","getLocalChannels","hasToken","saveUserChannels","channels","type","payload","getUserChannels","dispatch","res","get","data"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/src/store/actions/home.js"],"sourcesContent":["\nimport request from \"@/utils/request\";\nimport { setLocalChannels, getLocalChannels  } from \"@/utils/storage\";\nimport { hasToken } from \"@/utils/storage\";\n\n/**\n * 将用户频道保存到 Redux\n * @param {Array} channels\n * @returns\n */\nexport const saveUserChannels = (channels) => {\n  return {\n    type: 'home/channel',\n    payload: channels,\n  }\n}\n\n/**\n * 获取频道\n * @returns thunk\n */\nexport const getUserChannels = () => {\n  return async (dispatch) => {\n    // 1. 判断用户是否登录\n    if (hasToken()) {\n      const res = await request.get('/user/channels')\n      dispatch(saveUserChannels(res.data.channels))\n    } else {\n      // 2. 没有token,从本地获取频道数据\n      const channels = getLocalChannels()\n      if (channels) {\n        // 没有token，但本地有channels数据\n        dispatch(saveUserChannels(channels))\n      } else {\n        // 没有token, 且本地没有channels数据\n        const res = await request.get('/user/channels')\n        dispatch(saveUserChannels(res.data.channels))\n        // 保存到本地\n        setLocalChannels(res.data.channels)\n      }\n    }\n  }\n}"],"mappings":"AACA,OAAOA,OAAP,MAAoB,iBAApB;AACA,SAASC,gBAAT,EAA2BC,gBAA3B,QAAoD,iBAApD;AACA,SAASC,QAAT,QAAyB,iBAAzB;AAEA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,gBAAgB,GAAIC,QAAD,IAAc;EAC5C,OAAO;IACLC,IAAI,EAAE,cADD;IAELC,OAAO,EAAEF;EAFJ,CAAP;AAID,CALM;AAOP;AACA;AACA;AACA;;AACA,OAAO,MAAMG,eAAe,GAAG,MAAM;EACnC,OAAO,MAAOC,QAAP,IAAoB;IACzB;IACA,IAAIN,QAAQ,EAAZ,EAAgB;MACd,MAAMO,GAAG,GAAG,MAAMV,OAAO,CAACW,GAAR,CAAY,gBAAZ,CAAlB;MACAF,QAAQ,CAACL,gBAAgB,CAACM,GAAG,CAACE,IAAJ,CAASP,QAAV,CAAjB,CAAR;IACD,CAHD,MAGO;MACL;MACA,MAAMA,QAAQ,GAAGH,gBAAgB,EAAjC;;MACA,IAAIG,QAAJ,EAAc;QACZ;QACAI,QAAQ,CAACL,gBAAgB,CAACC,QAAD,CAAjB,CAAR;MACD,CAHD,MAGO;QACL;QACA,MAAMK,GAAG,GAAG,MAAMV,OAAO,CAACW,GAAR,CAAY,gBAAZ,CAAlB;QACAF,QAAQ,CAACL,gBAAgB,CAACM,GAAG,CAACE,IAAJ,CAASP,QAAV,CAAjB,CAAR,CAHK,CAIL;;QACAJ,gBAAgB,CAACS,GAAG,CAACE,IAAJ,CAASP,QAAV,CAAhB;MACD;IACF;EACF,CAnBD;AAoBD,CArBM"},"metadata":{},"sourceType":"module"}