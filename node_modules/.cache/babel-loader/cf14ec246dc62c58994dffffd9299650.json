{"ast":null,"code":"import React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel,\n  destroyOnClose: false,\n  forceRender: false\n};\nexport const Picker = memo(forwardRef((p, ref) => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [visible, setVisible] = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: v => {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  });\n  const actions = {\n    toggle: () => {\n      setVisible(v => !v);\n    },\n    open: () => {\n      setVisible(true);\n    },\n    close: () => {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, () => actions);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(() => {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    role: 'button',\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    role: 'button',\n    className: classNames(`${classPrefix}-header-button`, props.loading && `${classPrefix}-header-button-disabled`),\n    onClick: () => {\n      if (props.loading) return;\n      setValue(innerValue, true);\n      setVisible(false);\n    },\n    \"aria-disabled\": props.loading\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    loading: props.loading,\n    loadingContent: props.loadingContent,\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(`${classPrefix}-popup`, props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: props.destroyOnClose,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: props.forceRender,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';","map":{"version":3,"names":["React","useState","useEffect","forwardRef","useImperativeHandle","memo","classNames","Popup","mergeProps","withNativeProps","usePropsValue","PickerView","generateColumnsExtend","useColumnsExtend","useConfig","useMemoizedFn","SafeArea","defaultRenderLabel","classPrefix","defaultProps","defaultValue","closeOnMaskClick","renderLabel","destroyOnClose","forceRender","Picker","p","ref","_a","locale","props","confirmText","common","confirm","cancelText","cancel","visible","setVisible","value","onChange","v","onClose","call","actions","toggle","open","close","setValue","Object","assign","val","extend","columns","onConfirm","innerValue","setInnerValue","ext","onSelect","pickerElement","createElement","className","role","onClick","onCancel","title","loading","loadingContent","mouseWheel","popupElement","style","popupStyle","popupClassName","position","onMaskClick","getContainer","afterShow","afterClose","stopPropagation","Fragment","children","items","displayName"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/node_modules/antd-mobile/es/components/picker/picker.js"],"sourcesContent":["import React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel,\n  destroyOnClose: false,\n  forceRender: false\n};\nexport const Picker = memo(forwardRef((p, ref) => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [visible, setVisible] = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: v => {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  });\n  const actions = {\n    toggle: () => {\n      setVisible(v => !v);\n    },\n    open: () => {\n      setVisible(true);\n    },\n    close: () => {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, () => actions);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(() => {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    role: 'button',\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    role: 'button',\n    className: classNames(`${classPrefix}-header-button`, props.loading && `${classPrefix}-header-button-disabled`),\n    onClick: () => {\n      if (props.loading) return;\n      setValue(innerValue, true);\n      setVisible(false);\n    },\n    \"aria-disabled\": props.loading\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    loading: props.loading,\n    loadingContent: props.loadingContent,\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(`${classPrefix}-popup`, props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: props.destroyOnClose,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: props.forceRender,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';"],"mappings":"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"},"metadata":{},"sourceType":"module"}