{"ast":null,"code":"import React, { memo, useCallback, useEffect, useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Wheel } from './wheel';\nimport { useColumnsExtend } from './columns-extend';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDebounceEffect } from 'ahooks';\nimport { defaultRenderLabel } from '../picker/picker-utils';\nimport SpinLoading from '../spin-loading';\nconst classPrefix = `adm-picker-view`;\nconst defaultProps = {\n  defaultValue: [],\n  renderLabel: defaultRenderLabel,\n  mouseWheel: false,\n  loadingContent: React.createElement(\"div\", {\n    className: `${classPrefix}-loading-content`\n  }, React.createElement(SpinLoading, null))\n};\nexport const PickerView = memo(p => {\n  const props = mergeProps(defaultProps, p);\n  const [innerValue, setInnerValue] = useState(props.value === undefined ? props.defaultValue : props.value); // Sync `value` to `innerValue`\n\n  useEffect(() => {\n    if (props.value === undefined) return; // Uncontrolled mode\n\n    if (props.value === innerValue) return;\n    setInnerValue(props.value);\n  }, [props.value]);\n  useEffect(() => {\n    if (props.value === innerValue) return;\n    const timeout = window.setTimeout(() => {\n      if (props.value !== undefined && props.value !== innerValue) {\n        setInnerValue(props.value);\n      }\n    }, 1000);\n    return () => {\n      window.clearTimeout(timeout);\n    };\n  }, [props.value, innerValue]);\n  const extend = useColumnsExtend(props.columns, innerValue);\n  const columns = extend.columns;\n  useDebounceEffect(() => {\n    var _a;\n\n    if (props.value === innerValue) return;\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, innerValue, extend);\n  }, [innerValue], {\n    wait: 0,\n    leading: false,\n    trailing: true\n  });\n  const handleSelect = useCallback((val, index) => {\n    setInnerValue(prev => {\n      const next = [...prev];\n      next[index] = val;\n      return next;\n    });\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: `${classPrefix}`\n  }, props.loading ? props.loadingContent : React.createElement(React.Fragment, null, columns.map((column, index) => React.createElement(Wheel, {\n    key: index,\n    index: index,\n    column: column,\n    value: innerValue[index],\n    onSelect: handleSelect,\n    renderLabel: props.renderLabel,\n    mouseWheel: props.mouseWheel\n  })), React.createElement(\"div\", {\n    className: `${classPrefix}-mask`\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-mask-top`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-middle`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-bottom`\n  })))));\n});\nPickerView.displayName = 'PickerView';","map":{"version":3,"names":["React","memo","useCallback","useEffect","useState","mergeProps","Wheel","useColumnsExtend","withNativeProps","useDebounceEffect","defaultRenderLabel","SpinLoading","classPrefix","defaultProps","defaultValue","renderLabel","mouseWheel","loadingContent","createElement","className","PickerView","p","props","innerValue","setInnerValue","value","undefined","timeout","window","setTimeout","clearTimeout","extend","columns","_a","onChange","call","wait","leading","trailing","handleSelect","val","index","prev","next","loading","Fragment","map","column","key","onSelect","displayName"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/node_modules/antd-mobile/es/components/picker-view/picker-view.js"],"sourcesContent":["import React, { memo, useCallback, useEffect, useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Wheel } from './wheel';\nimport { useColumnsExtend } from './columns-extend';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDebounceEffect } from 'ahooks';\nimport { defaultRenderLabel } from '../picker/picker-utils';\nimport SpinLoading from '../spin-loading';\nconst classPrefix = `adm-picker-view`;\nconst defaultProps = {\n  defaultValue: [],\n  renderLabel: defaultRenderLabel,\n  mouseWheel: false,\n  loadingContent: React.createElement(\"div\", {\n    className: `${classPrefix}-loading-content`\n  }, React.createElement(SpinLoading, null))\n};\nexport const PickerView = memo(p => {\n  const props = mergeProps(defaultProps, p);\n  const [innerValue, setInnerValue] = useState(props.value === undefined ? props.defaultValue : props.value); // Sync `value` to `innerValue`\n\n  useEffect(() => {\n    if (props.value === undefined) return; // Uncontrolled mode\n\n    if (props.value === innerValue) return;\n    setInnerValue(props.value);\n  }, [props.value]);\n  useEffect(() => {\n    if (props.value === innerValue) return;\n    const timeout = window.setTimeout(() => {\n      if (props.value !== undefined && props.value !== innerValue) {\n        setInnerValue(props.value);\n      }\n    }, 1000);\n    return () => {\n      window.clearTimeout(timeout);\n    };\n  }, [props.value, innerValue]);\n  const extend = useColumnsExtend(props.columns, innerValue);\n  const columns = extend.columns;\n  useDebounceEffect(() => {\n    var _a;\n\n    if (props.value === innerValue) return;\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, innerValue, extend);\n  }, [innerValue], {\n    wait: 0,\n    leading: false,\n    trailing: true\n  });\n  const handleSelect = useCallback((val, index) => {\n    setInnerValue(prev => {\n      const next = [...prev];\n      next[index] = val;\n      return next;\n    });\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: `${classPrefix}`\n  }, props.loading ? props.loadingContent : React.createElement(React.Fragment, null, columns.map((column, index) => React.createElement(Wheel, {\n    key: index,\n    index: index,\n    column: column,\n    value: innerValue[index],\n    onSelect: handleSelect,\n    renderLabel: props.renderLabel,\n    mouseWheel: props.mouseWheel\n  })), React.createElement(\"div\", {\n    className: `${classPrefix}-mask`\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-mask-top`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-middle`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-bottom`\n  })))));\n});\nPickerView.displayName = 'PickerView';"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,IAAhB,EAAsBC,WAAtB,EAAmCC,SAAnC,EAA8CC,QAA9C,QAA8D,OAA9D;AACA,SAASC,UAAT,QAA2B,gCAA3B;AACA,SAASC,KAAT,QAAsB,SAAtB;AACA,SAASC,gBAAT,QAAiC,kBAAjC;AACA,SAASC,eAAT,QAAgC,0BAAhC;AACA,SAASC,iBAAT,QAAkC,QAAlC;AACA,SAASC,kBAAT,QAAmC,wBAAnC;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,MAAMC,WAAW,GAAI,iBAArB;AACA,MAAMC,YAAY,GAAG;EACnBC,YAAY,EAAE,EADK;EAEnBC,WAAW,EAAEL,kBAFM;EAGnBM,UAAU,EAAE,KAHO;EAInBC,cAAc,EAAEjB,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IACzCC,SAAS,EAAG,GAAEP,WAAY;EADe,CAA3B,EAEbZ,KAAK,CAACkB,aAAN,CAAoBP,WAApB,EAAiC,IAAjC,CAFa;AAJG,CAArB;AAQA,OAAO,MAAMS,UAAU,GAAGnB,IAAI,CAACoB,CAAC,IAAI;EAClC,MAAMC,KAAK,GAAGjB,UAAU,CAACQ,YAAD,EAAeQ,CAAf,CAAxB;EACA,MAAM,CAACE,UAAD,EAAaC,aAAb,IAA8BpB,QAAQ,CAACkB,KAAK,CAACG,KAAN,KAAgBC,SAAhB,GAA4BJ,KAAK,CAACR,YAAlC,GAAiDQ,KAAK,CAACG,KAAxD,CAA5C,CAFkC,CAE0E;;EAE5GtB,SAAS,CAAC,MAAM;IACd,IAAImB,KAAK,CAACG,KAAN,KAAgBC,SAApB,EAA+B,OADjB,CACyB;;IAEvC,IAAIJ,KAAK,CAACG,KAAN,KAAgBF,UAApB,EAAgC;IAChCC,aAAa,CAACF,KAAK,CAACG,KAAP,CAAb;EACD,CALQ,EAKN,CAACH,KAAK,CAACG,KAAP,CALM,CAAT;EAMAtB,SAAS,CAAC,MAAM;IACd,IAAImB,KAAK,CAACG,KAAN,KAAgBF,UAApB,EAAgC;IAChC,MAAMI,OAAO,GAAGC,MAAM,CAACC,UAAP,CAAkB,MAAM;MACtC,IAAIP,KAAK,CAACG,KAAN,KAAgBC,SAAhB,IAA6BJ,KAAK,CAACG,KAAN,KAAgBF,UAAjD,EAA6D;QAC3DC,aAAa,CAACF,KAAK,CAACG,KAAP,CAAb;MACD;IACF,CAJe,EAIb,IAJa,CAAhB;IAKA,OAAO,MAAM;MACXG,MAAM,CAACE,YAAP,CAAoBH,OAApB;IACD,CAFD;EAGD,CAVQ,EAUN,CAACL,KAAK,CAACG,KAAP,EAAcF,UAAd,CAVM,CAAT;EAWA,MAAMQ,MAAM,GAAGxB,gBAAgB,CAACe,KAAK,CAACU,OAAP,EAAgBT,UAAhB,CAA/B;EACA,MAAMS,OAAO,GAAGD,MAAM,CAACC,OAAvB;EACAvB,iBAAiB,CAAC,MAAM;IACtB,IAAIwB,EAAJ;;IAEA,IAAIX,KAAK,CAACG,KAAN,KAAgBF,UAApB,EAAgC;IAChC,CAACU,EAAE,GAAGX,KAAK,CAACY,QAAZ,MAA0B,IAA1B,IAAkCD,EAAE,KAAK,KAAK,CAA9C,GAAkD,KAAK,CAAvD,GAA2DA,EAAE,CAACE,IAAH,CAAQb,KAAR,EAAeC,UAAf,EAA2BQ,MAA3B,CAA3D;EACD,CALgB,EAKd,CAACR,UAAD,CALc,EAKA;IACfa,IAAI,EAAE,CADS;IAEfC,OAAO,EAAE,KAFM;IAGfC,QAAQ,EAAE;EAHK,CALA,CAAjB;EAUA,MAAMC,YAAY,GAAGrC,WAAW,CAAC,CAACsC,GAAD,EAAMC,KAAN,KAAgB;IAC/CjB,aAAa,CAACkB,IAAI,IAAI;MACpB,MAAMC,IAAI,GAAG,CAAC,GAAGD,IAAJ,CAAb;MACAC,IAAI,CAACF,KAAD,CAAJ,GAAcD,GAAd;MACA,OAAOG,IAAP;IACD,CAJY,CAAb;EAKD,CAN+B,EAM7B,EAN6B,CAAhC;EAOA,OAAOnC,eAAe,CAACc,KAAD,EAAQtB,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IACvDC,SAAS,EAAG,GAAEP,WAAY;EAD6B,CAA3B,EAE3BU,KAAK,CAACsB,OAAN,GAAgBtB,KAAK,CAACL,cAAtB,GAAuCjB,KAAK,CAACkB,aAAN,CAAoBlB,KAAK,CAAC6C,QAA1B,EAAoC,IAApC,EAA0Cb,OAAO,CAACc,GAAR,CAAY,CAACC,MAAD,EAASN,KAAT,KAAmBzC,KAAK,CAACkB,aAAN,CAAoBZ,KAApB,EAA2B;IAC5I0C,GAAG,EAAEP,KADuI;IAE5IA,KAAK,EAAEA,KAFqI;IAG5IM,MAAM,EAAEA,MAHoI;IAI5ItB,KAAK,EAAEF,UAAU,CAACkB,KAAD,CAJ2H;IAK5IQ,QAAQ,EAAEV,YALkI;IAM5IxB,WAAW,EAAEO,KAAK,CAACP,WANyH;IAO5IC,UAAU,EAAEM,KAAK,CAACN;EAP0H,CAA3B,CAA/B,CAA1C,EAQrChB,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IAC9BC,SAAS,EAAG,GAAEP,WAAY;EADI,CAA3B,EAEFZ,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IAC5BC,SAAS,EAAG,GAAEP,WAAY;EADE,CAA3B,CAFE,EAIDZ,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IAC7BC,SAAS,EAAG,GAAEP,WAAY;EADG,CAA3B,CAJC,EAMDZ,KAAK,CAACkB,aAAN,CAAoB,KAApB,EAA2B;IAC7BC,SAAS,EAAG,GAAEP,WAAY;EADG,CAA3B,CANC,CARqC,CAFZ,CAAR,CAAtB;AAmBD,CA3D6B,CAAvB;AA4DPQ,UAAU,CAAC8B,WAAX,GAAyB,YAAzB"},"metadata":{},"sourceType":"module"}