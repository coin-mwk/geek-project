{"ast":null,"code":"import React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { renderToBody } from './render-to-body';\nexport function renderImperatively(element) {\n  const Wrapper = React.forwardRef((_, ref) => {\n    const [visible, setVisible] = useState(false);\n    const closedRef = useRef(false);\n    const [elementToRender, setElementToRender] = useState(element);\n    const keyRef = useRef(0);\n    useEffect(() => {\n      if (!closedRef.current) {\n        setVisible(true);\n      } else {\n        afterClose();\n      }\n    }, []);\n\n    function onClose() {\n      var _a, _b;\n\n      closedRef.current = true;\n      setVisible(false);\n      (_b = (_a = elementToRender.props).onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    function afterClose() {\n      var _a, _b;\n\n      unmount();\n      (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    useImperativeHandle(ref, () => ({\n      close: onClose,\n      replace: element => {\n        var _a, _b;\n\n        keyRef.current++;\n        (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        setElementToRender(element);\n      }\n    }));\n    return React.cloneElement(elementToRender, Object.assign(Object.assign({}, elementToRender.props), {\n      key: keyRef.current,\n      visible,\n      onClose,\n      afterClose\n    }));\n  });\n  const wrapperRef = React.createRef();\n  const unmount = renderToBody(React.createElement(Wrapper, {\n    ref: wrapperRef\n  }));\n  return {\n    close: () => {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    replace: element => {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.replace(element);\n    }\n  };\n}","map":{"version":3,"names":["React","useEffect","useImperativeHandle","useRef","useState","renderToBody","renderImperatively","element","Wrapper","forwardRef","_","ref","visible","setVisible","closedRef","elementToRender","setElementToRender","keyRef","current","afterClose","onClose","_a","_b","props","call","unmount","close","replace","cloneElement","Object","assign","key","wrapperRef","createRef","createElement"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/node_modules/antd-mobile/es/utils/render-imperatively.js"],"sourcesContent":["import React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { renderToBody } from './render-to-body';\nexport function renderImperatively(element) {\n  const Wrapper = React.forwardRef((_, ref) => {\n    const [visible, setVisible] = useState(false);\n    const closedRef = useRef(false);\n    const [elementToRender, setElementToRender] = useState(element);\n    const keyRef = useRef(0);\n    useEffect(() => {\n      if (!closedRef.current) {\n        setVisible(true);\n      } else {\n        afterClose();\n      }\n    }, []);\n    function onClose() {\n      var _a, _b;\n      closedRef.current = true;\n      setVisible(false);\n      (_b = (_a = elementToRender.props).onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n    function afterClose() {\n      var _a, _b;\n      unmount();\n      (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n    useImperativeHandle(ref, () => ({\n      close: onClose,\n      replace: element => {\n        var _a, _b;\n        keyRef.current++;\n        (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        setElementToRender(element);\n      }\n    }));\n    return React.cloneElement(elementToRender, Object.assign(Object.assign({}, elementToRender.props), {\n      key: keyRef.current,\n      visible,\n      onClose,\n      afterClose\n    }));\n  });\n  const wrapperRef = React.createRef();\n  const unmount = renderToBody(React.createElement(Wrapper, {\n    ref: wrapperRef\n  }));\n  return {\n    close: () => {\n      var _a;\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    replace: element => {\n      var _a;\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.replace(element);\n    }\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}