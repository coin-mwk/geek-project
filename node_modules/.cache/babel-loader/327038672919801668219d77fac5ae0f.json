{"ast":null,"code":"import React, { useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport List from '../list';\nimport { DownOutline } from 'antd-mobile-icons';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useMount } from 'ahooks';\nimport { useShouldRender } from '../../utils/should-render';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nconst classPrefix = `adm-collapse`;\nexport const CollapsePanel = () => {\n  return null;\n};\n\nconst CollapsePanelContent = props => {\n  const {\n    visible\n  } = props;\n  const innerRef = useRef(null);\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const [{\n    height\n  }, api] = useSpring(() => ({\n    from: {\n      height: 0\n    },\n    config: {\n      precision: 0.01,\n      mass: 1,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    }\n  }));\n  useMount(() => {\n    if (!visible) return;\n    const inner = innerRef.current;\n    if (!inner) return;\n    api.start({\n      height: inner.offsetHeight,\n      immediate: true\n    });\n  });\n  useIsomorphicUpdateLayoutEffect(() => {\n    const inner = innerRef.current;\n    if (!inner) return;\n\n    if (visible) {\n      api.start({\n        height: inner.offsetHeight\n      });\n    } else {\n      api.start({\n        height: inner.offsetHeight,\n        immediate: true\n      });\n      api.start({\n        height: 0\n      });\n    }\n  }, [visible]);\n  return React.createElement(animated.div, {\n    className: `${classPrefix}-panel-content`,\n    style: {\n      height: height.to(v => {\n        if (height.idle && visible) {\n          return 'auto';\n        } else {\n          return v;\n        }\n      })\n    }\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-panel-content-inner`,\n    ref: innerRef\n  }, React.createElement(List.Item, null, shouldRender && props.children)));\n};\n\nexport const Collapse = props => {\n  var _a;\n\n  const panels = [];\n  traverseReactNode(props.children, child => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n    panels.push(child);\n  });\n  const [activeKey, setActiveKey] = usePropsValue(props.accordion ? {\n    value: props.activeKey === undefined ? undefined : props.activeKey === null ? [] : [props.activeKey],\n    defaultValue: props.defaultActiveKey === undefined || props.defaultActiveKey === null ? [] : [props.defaultActiveKey],\n    onChange: v => {\n      var _a, _b;\n\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, (_b = v[0]) !== null && _b !== void 0 ? _b : null);\n    }\n  } : {\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : [],\n    onChange: props.onChange\n  });\n  const activeKeyList = activeKey === null ? [] : Array.isArray(activeKey) ? activeKey : [activeKey];\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(List, null, panels.map(panel => {\n    const key = panel.key;\n    const active = activeKeyList.includes(key);\n\n    function handleClick(event) {\n      var _a, _b;\n\n      if (props.accordion) {\n        if (active) {\n          setActiveKey([]);\n        } else {\n          setActiveKey([key]);\n        }\n      } else {\n        if (active) {\n          setActiveKey(activeKeyList.filter(v => v !== key));\n        } else {\n          setActiveKey([...activeKeyList, key]);\n        }\n      }\n\n      (_b = (_a = panel.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    }\n\n    const renderArrow = () => {\n      let arrow = React.createElement(DownOutline, null);\n\n      if (props.arrow !== undefined) {\n        arrow = props.arrow;\n      }\n\n      if (panel.props.arrow !== undefined) {\n        arrow = panel.props.arrow;\n      }\n\n      return typeof arrow === 'function' ? arrow(active) : React.createElement(\"div\", {\n        className: classNames(`${classPrefix}-arrow`, {\n          [`${classPrefix}-arrow-active`]: active\n        })\n      }, arrow);\n    };\n\n    return React.createElement(React.Fragment, {\n      key: key\n    }, withNativeProps(panel.props, React.createElement(List.Item, {\n      className: `${classPrefix}-panel-header`,\n      onClick: handleClick,\n      disabled: panel.props.disabled,\n      arrow: renderArrow()\n    }, panel.props.title)), React.createElement(CollapsePanelContent, {\n      visible: active,\n      forceRender: !!panel.props.forceRender,\n      destroyOnClose: !!panel.props.destroyOnClose\n    }, panel.props.children));\n  }))));\n};","map":{"version":3,"names":["React","useRef","withNativeProps","List","DownOutline","classNames","useSpring","animated","usePropsValue","useMount","useShouldRender","useIsomorphicUpdateLayoutEffect","traverseReactNode","classPrefix","CollapsePanel","CollapsePanelContent","props","visible","innerRef","shouldRender","forceRender","destroyOnClose","height","api","from","config","precision","mass","tension","friction","clamp","inner","current","start","offsetHeight","immediate","createElement","div","className","style","to","v","idle","ref","Item","children","Collapse","_a","panels","child","isValidElement","key","push","activeKey","setActiveKey","accordion","value","undefined","defaultValue","defaultActiveKey","onChange","_b","call","activeKeyList","Array","isArray","map","panel","active","includes","handleClick","event","filter","onClick","renderArrow","arrow","Fragment","disabled","title"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/node_modules/antd-mobile/es/components/collapse/collapse.js"],"sourcesContent":["import React, { useRef } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport List from '../list';\nimport { DownOutline } from 'antd-mobile-icons';\nimport classNames from 'classnames';\nimport { useSpring, animated } from '@react-spring/web';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useMount } from 'ahooks';\nimport { useShouldRender } from '../../utils/should-render';\nimport { useIsomorphicUpdateLayoutEffect } from '../../utils/use-isomorphic-update-layout-effect';\nimport { traverseReactNode } from '../../utils/traverse-react-node';\nconst classPrefix = `adm-collapse`;\nexport const CollapsePanel = () => {\n  return null;\n};\n\nconst CollapsePanelContent = props => {\n  const {\n    visible\n  } = props;\n  const innerRef = useRef(null);\n  const shouldRender = useShouldRender(visible, props.forceRender, props.destroyOnClose);\n  const [{\n    height\n  }, api] = useSpring(() => ({\n    from: {\n      height: 0\n    },\n    config: {\n      precision: 0.01,\n      mass: 1,\n      tension: 200,\n      friction: 25,\n      clamp: true\n    }\n  }));\n  useMount(() => {\n    if (!visible) return;\n    const inner = innerRef.current;\n    if (!inner) return;\n    api.start({\n      height: inner.offsetHeight,\n      immediate: true\n    });\n  });\n  useIsomorphicUpdateLayoutEffect(() => {\n    const inner = innerRef.current;\n    if (!inner) return;\n\n    if (visible) {\n      api.start({\n        height: inner.offsetHeight\n      });\n    } else {\n      api.start({\n        height: inner.offsetHeight,\n        immediate: true\n      });\n      api.start({\n        height: 0\n      });\n    }\n  }, [visible]);\n  return React.createElement(animated.div, {\n    className: `${classPrefix}-panel-content`,\n    style: {\n      height: height.to(v => {\n        if (height.idle && visible) {\n          return 'auto';\n        } else {\n          return v;\n        }\n      })\n    }\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-panel-content-inner`,\n    ref: innerRef\n  }, React.createElement(List.Item, null, shouldRender && props.children)));\n};\n\nexport const Collapse = props => {\n  var _a;\n\n  const panels = [];\n  traverseReactNode(props.children, child => {\n    if (!React.isValidElement(child)) return;\n    const key = child.key;\n    if (typeof key !== 'string') return;\n    panels.push(child);\n  });\n  const [activeKey, setActiveKey] = usePropsValue(props.accordion ? {\n    value: props.activeKey === undefined ? undefined : props.activeKey === null ? [] : [props.activeKey],\n    defaultValue: props.defaultActiveKey === undefined || props.defaultActiveKey === null ? [] : [props.defaultActiveKey],\n    onChange: v => {\n      var _a, _b;\n\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, (_b = v[0]) !== null && _b !== void 0 ? _b : null);\n    }\n  } : {\n    value: props.activeKey,\n    defaultValue: (_a = props.defaultActiveKey) !== null && _a !== void 0 ? _a : [],\n    onChange: props.onChange\n  });\n  const activeKeyList = activeKey === null ? [] : Array.isArray(activeKey) ? activeKey : [activeKey];\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(List, null, panels.map(panel => {\n    const key = panel.key;\n    const active = activeKeyList.includes(key);\n\n    function handleClick(event) {\n      var _a, _b;\n\n      if (props.accordion) {\n        if (active) {\n          setActiveKey([]);\n        } else {\n          setActiveKey([key]);\n        }\n      } else {\n        if (active) {\n          setActiveKey(activeKeyList.filter(v => v !== key));\n        } else {\n          setActiveKey([...activeKeyList, key]);\n        }\n      }\n\n      (_b = (_a = panel.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a, event);\n    }\n\n    const renderArrow = () => {\n      let arrow = React.createElement(DownOutline, null);\n\n      if (props.arrow !== undefined) {\n        arrow = props.arrow;\n      }\n\n      if (panel.props.arrow !== undefined) {\n        arrow = panel.props.arrow;\n      }\n\n      return typeof arrow === 'function' ? arrow(active) : React.createElement(\"div\", {\n        className: classNames(`${classPrefix}-arrow`, {\n          [`${classPrefix}-arrow-active`]: active\n        })\n      }, arrow);\n    };\n\n    return React.createElement(React.Fragment, {\n      key: key\n    }, withNativeProps(panel.props, React.createElement(List.Item, {\n      className: `${classPrefix}-panel-header`,\n      onClick: handleClick,\n      disabled: panel.props.disabled,\n      arrow: renderArrow()\n    }, panel.props.title)), React.createElement(CollapsePanelContent, {\n      visible: active,\n      forceRender: !!panel.props.forceRender,\n      destroyOnClose: !!panel.props.destroyOnClose\n    }, panel.props.children));\n  }))));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}