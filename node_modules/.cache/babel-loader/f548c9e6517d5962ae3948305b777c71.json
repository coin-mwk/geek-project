{"ast":null,"code":"import request from \"@/utils/request\";\nimport { setLocalChannels, get } from \"@/utils/storage\";\n/**\n * 将用户频道保存到 Redux\n * @param {Array} channels\n * @returns\n */\n\nexport const setUserChannels = channels => {\n  return {\n    type: 'home/channel',\n    payload: channels\n  };\n};\n/**\n * 获取频道\n * @returns thunk\n */\n\nexport const getUserChannels = () => {\n  return async dispatch => {\n    // 1. 判断用户是否登录\n    if (hasToken()) {\n      const res = await request.get('/user/channels');\n      dispatch(saveUserChannels(res.data.channels));\n    } else {\n      // 2. 没有token,从本地获取频道数据\n      const channels = getLocalChannels();\n\n      if (channels) {\n        // 没有token，但本地有channels数据\n        dispatch(saveUserChannels(channels));\n      } else {\n        // 没有token, 且本地没有channels数据\n        const res = await request.get('/user/channels');\n        dispatch(saveUserChannels(res.data.channels)); // 保存到本地\n\n        setLocalChannels(res.data.channels);\n      }\n    }\n  };\n};","map":{"version":3,"names":["request","setLocalChannels","get","setUserChannels","channels","type","payload","getUserChannels","dispatch","hasToken","res","saveUserChannels","data","getLocalChannels"],"sources":["/Users/tonystark/code/VSCodeProject/react/gk-h5/src/store/actions/home.js"],"sourcesContent":["\nimport request from \"@/utils/request\"\nimport { setLocalChannels, get  } from \"@/utils/storage\"\n\n/**\n * 将用户频道保存到 Redux\n * @param {Array} channels\n * @returns\n */\nexport const setUserChannels = (channels) => {\n  return {\n    type: 'home/channel',\n    payload: channels,\n  }\n}\n\n/**\n * 获取频道\n * @returns thunk\n */\nexport const getUserChannels = () => {\n  return async (dispatch) => {\n    // 1. 判断用户是否登录\n    if (hasToken()) {\n      const res = await request.get('/user/channels')\n      dispatch(saveUserChannels(res.data.channels))\n    } else {\n      // 2. 没有token,从本地获取频道数据\n      const channels = getLocalChannels()\n      if (channels) {\n        // 没有token，但本地有channels数据\n        dispatch(saveUserChannels(channels))\n      } else {\n        // 没有token, 且本地没有channels数据\n        const res = await request.get('/user/channels')\n        dispatch(saveUserChannels(res.data.channels))\n        // 保存到本地\n        setLocalChannels(res.data.channels)\n      }\n    }\n  }\n}"],"mappings":"AACA,OAAOA,OAAP,MAAoB,iBAApB;AACA,SAASC,gBAAT,EAA2BC,GAA3B,QAAuC,iBAAvC;AAEA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,eAAe,GAAIC,QAAD,IAAc;EAC3C,OAAO;IACLC,IAAI,EAAE,cADD;IAELC,OAAO,EAAEF;EAFJ,CAAP;AAID,CALM;AAOP;AACA;AACA;AACA;;AACA,OAAO,MAAMG,eAAe,GAAG,MAAM;EACnC,OAAO,MAAOC,QAAP,IAAoB;IACzB;IACA,IAAIC,QAAQ,EAAZ,EAAgB;MACd,MAAMC,GAAG,GAAG,MAAMV,OAAO,CAACE,GAAR,CAAY,gBAAZ,CAAlB;MACAM,QAAQ,CAACG,gBAAgB,CAACD,GAAG,CAACE,IAAJ,CAASR,QAAV,CAAjB,CAAR;IACD,CAHD,MAGO;MACL;MACA,MAAMA,QAAQ,GAAGS,gBAAgB,EAAjC;;MACA,IAAIT,QAAJ,EAAc;QACZ;QACAI,QAAQ,CAACG,gBAAgB,CAACP,QAAD,CAAjB,CAAR;MACD,CAHD,MAGO;QACL;QACA,MAAMM,GAAG,GAAG,MAAMV,OAAO,CAACE,GAAR,CAAY,gBAAZ,CAAlB;QACAM,QAAQ,CAACG,gBAAgB,CAACD,GAAG,CAACE,IAAJ,CAASR,QAAV,CAAjB,CAAR,CAHK,CAIL;;QACAH,gBAAgB,CAACS,GAAG,CAACE,IAAJ,CAASR,QAAV,CAAhB;MACD;IACF;EACF,CAnBD;AAoBD,CArBM"},"metadata":{},"sourceType":"module"}